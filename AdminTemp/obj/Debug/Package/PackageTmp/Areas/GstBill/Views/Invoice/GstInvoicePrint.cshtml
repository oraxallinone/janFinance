@model AdminTemp.Areas.GstBill.Models.InvoiceGstViewModel
@{
    Layout = null;
}

<!DOCTYPE html>

<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title>GstInvoicePrint</title>
    <link href="~/theme/printBillStyle.css" rel="stylesheet" />

</head>
<body>
    <div id="tblInvoice">


        <table class="table" border="1">
            <tr class="bgLight">
                <td colspan="6" class="textCenter fontHeader border0-bottom ">
                    Tax Invoice
                </td>
            </tr>
            <tr class="bgLight">
                <td colspan="6" class="textCenter fontSubHeader border0-bottom">
                    <span>M/S. ANNAPURNA SWEETS </span><br>
                    <span>Duburi,&nbsp; Kalinganagar&nbsp;,&nbsp;Jajpur&nbsp;,&nbsp; Odisha-755026</span><br>
                    <span>Mob-7873444133, &nbsp;&nbsp;Email- tasteavenue.d@gmail.com</span><br>
                    <span>GSTIN- 21EQZPS3634F1ZF</span>
                </td>
            </tr>
            <tr class="bg1">
                <td colspan="3" class="fontSubHeader border0-bottom border0-right">
                    <span>To </span><br>
                    <span class="marginLeft" style="text-transform: capitalize; "> @Model.custName </span><br>
                    <span class="marginLeft">@Model.cusstAdd1 </span><br>
                    <span class="marginLeft">@Model.custAdd2 </span>
                    <span class="marginLeft">@Model.custAdd3 </span><br />
                    <span class="marginLeft">GSTIN No : </span><span>@Model.custGstin </span>
                    @Html.HiddenFor(m => m.IGstType)
                </td>
                <td colspan="3" class="fontSubHeader textRight  border0-bottom">
                    <table width="100%" class="tableBorderColaps">
                        <tr>
                            <td style="border: 0">
                                Invoice No: @Model.INo
                            </td>
                        </tr>
                        <tr>
                            <td style="border-left: 0;border-right: 0;border-bottom: 0;">
                                Invoice Date: @( Model.IDate.HasValue ? Model.IDate.Value.ToString("dd-MM-yyyy") : "")
                            </td>
                        </tr>
                        <tr>
                            <td style="border-left: 0;border-right: 0;border-bottom: 0;">
                                DO Number: @( Model.IDate.HasValue ? Model.IDate.Value.ToString("dd-MM-yyyy") : "")
                            </td>
                        </tr>
                    </table>
                </td>
            </tr>
            <tr class="bg1">
                <td colspan="6" class="textCenter">
                    <!-- Lunch at here --> &nbsp; some notes
                </td>
            </tr>
            <tr>
                <td colspan="6" class="textCenter border-top0 border-bottom0">
                    Part A (Service Items)
                </td>
            </tr>
            <tr class="fontMenuHeader textCenter ">
                <td style="width:5% ;text-align: center;" class="border-right0">S.N.</td>
                <td style="width:31% ;" class="border-right0"> Details </td>
                <td style="width:9% ;" class="border-right0"> HSN/SAC </td>
                <td style="width:7% ;" class="border-right0"> Qnty </td>
                <td style="width:13% ;" class="border-right0"> Rate</td>
                <td style="width:10% ;"> TOTAL </td>
                <td style="width:8% ;display: none;"> TOTAL </td>

            </tr>
            @{
                int snNo = 0;
                foreach (var ss in Model.ItemTransList)
                {
                    if (ss.itm_Part == "a")
                    {
                        snNo = snNo + 1;
                        <tr class="fontMenuBody cTableRow border-right0">
                            <td class="textCenter cItmCode border-right0 border-top0">@snNo</td>
                            <td class="cItmName border-right0 border-top0"> @ss.itm_ItemDetails </td>
                            <td class="textCenter cItmHsn border-right0 border-top0">@ss.itm_HSN</td>
                            <td class="textCenter cItmQty border-right0 border-top0">@ss.itm_Quantity</td>
                            <td class="textCenter cItmRate border-right0 border-top0">@ss.itm_Rate </td>
                            <td class="textRight cItmValue  border-top0 partA-total">@ss.itm_Value </td>
                        </tr>
                    }

                }
            }

            <tr class="fontMenuHeader2">
                <td class="textRight" colspan="5" style="border-top: 0px;border-right: 0px"></td>
                <td class="textRight" colspan="1" style="border-top: 0px;" id="lbl_sum_partA"></td>
            </tr>
            <tr class="fontMenuHeader2">
                <td class="textRight font-size-2" colspan="5" style="border-top: 0px;border-right: 0px">CGST@2.5 &nbsp;</td>
                <td class="textRight " colspan="1" style="border-top: 0px" id="lbl_cgst"></td>
            </tr>
            <tr class="fontMenuHeader2">
                <td class="textRight font-size-2" colspan="5" style="border-top: 0px;border-right: 0px">SGST@2.5 &nbsp;</td>
                <td class="textRight" colspan="1" style="border-top: 0px" id="lbl_sgst"></td>
            </tr>
            <tr class="fontMenuHeader2">
                <td class="textRight font-size-2" colspan="5" style="border-top: 0px;border-right: 0px">TotalGst(CGST+SGST) &nbsp;</td>
                <td class="textRight" colspan="1" style="border-top: 0px" id="lbl_toal_gst"></td>
            </tr>
            <tr class="fontMenuHeader2" style="border-top: 0px">
                <td class="textRight font-size-2" colspan="5" style="border-top: 0px;border-right: 0px">Sub Total Amount Rs. (Part A) &nbsp;</td>
                <td class="textRight" colspan="1" style="border-top: 0px" id="lbl_partA_subTotal"></td>
            </tr>

            <tr>
                <td colspan="6" class="textCenter" style="border-top: 0px;border-bottom: 0px">
                    Part B (Supply Items)
                </td>
            </tr>

            <tr class="fontMenuHeader textCenter ">
                <td style="width:5% ;text-align: center;" class="border-right0"> S.N. </td>
                <td style="width:51% ;" class="border-right0"> Details </td>
                <td style="width:9% ;" class="border-right0"> HSN/SAC </td>
                <td style="width:7% ;" class="border-right0"> Qnty </td>
                <td style="width:10% ;" class="border-right0"> Rate </td>
                <td style="width:8% ;"> TOTAL </td>
            </tr>
            @{
                int snNo2 = 0;
                foreach (var ss in Model.ItemTransList)
                {
                    if (ss.itm_Part == "b")
                    {
                        snNo2 = snNo2 + 1;
                        <tr class="fontMenuBody cTableRow">
                            <td class="textCenter cItmCode border-top0 border-right0">@snNo2</td>
                            <td class="cItmName border-top0 border-right0"> @ss.itm_ItemDetails </td>
                            <td class="textCenter cItmHsn border-top0 border-right0">@ss.itm_HSN</td>
                            <td class="textCenter cItmQty border-top0 border-right0">@ss.itm_Quantity</td>
                            <td class="textCenter cItmRate border-top0 border-right0">@ss.itm_Rate </td>
                            <td class="textRight cItmValue border-top0 partB-total">@ss.itm_Value </td>
                        </tr>
                    }

                }
            }

            <tr class="fontMenuHeader2">
                <td colspan="5" class="textRight" style="border-top: 0px; border-right:0;">Sub Total Amount Rs. (Part B) &nbsp;</td>
                <td colspan="1" class="textRight" style="border-top: 0px;" id="lbl_partB_subTotal"></td>
            </tr>


            <tr class="fontMenuHeader2">
                <td class="textCenter" colspan="5" style="border-top: 0px;border-right:0;"> Grand Total Amount Rs. (Part A + part B)</td>
                <td class="textRight" colspan="1" style="border-top: 0px;" id="lbl_grandTotal"></td>

            </tr>
            <tr class="bg1">
                <td colspan="6" class="textCenter" style="border-top: 0px;">
                    Rupees in words - ( <span id="wordprint">  </span>  &nbsp; rupees only  )
                </td>
            </tr>
            <tr class="bgLight footerHeight textRight">
                <td colspan="6" style="border-top: 0px;">
                    <div class="marginRight">
                        For M/S. ANNAPURNA SWEETS
                        <br> <br><br>
                        Auttorised Signature
                    </div>
                    <br>
                </td>
            </tr>
        </table>




    </div>
    <div style="margin-left: 17%;">
        <input type="button" class="btn btn-success" onclick="PrintDiv();" value="Print" />| <a href="/GstBill/Invoice/GstInvoiceList">Invoice List</a> | <a href="/Invoice/GstInvoiceCreate" style="color:green">Create New Invoice</a>
    </div>


    <script src="~/Scripts/jquery-3.6.0.js"></script>

    <script type="text/javascript">

        function PrintDiv() {
            var divContents = document.getElementById("tblInvoice").innerHTML;
            var printWindow = window.open('', '', 'height=600,width=1200');
            printWindow.document.write("<html><head><title>Bill Content2</title> <style type='text/css'> .table { width: 700px; font-family: 'Times New Roman'; font-size: 14px; border-spacing: 0; border-width: 0; padding: 0; border-width: 0; } .tableBorderColaps { height: 73px; border-spacing: 0; border-width: 0; padding: 0; border-width: 0; } .bgLight { background-color: #e0f7faa1; } .textCenter { text-align: center; } .textRight { text-align: right; } .textLeft { text-align: left; } .fontHeader { font-size: 25px; font-weight: bolder; } .fontSubHeader { font-size: 15px; font-weight: bolder; } .fontMenuHeader { font-size: 13px; font-weight: bolder; height: 40px; background-color: #e0f7faa1; } .fontMenuHeader2 { font-size: 13px; font-weight: bolder; height: 20px; background-color: #e0f7faa1; } .bg1 { background-color: #e0f7faa1; } .border-top0 { border-top: 0px !important; } .border-bottom0 { border-bottom: 0px !important; } .border-right0 { border-right: 0px !important; } .border-left0 { border-left: 0px !important; } .fontMenuBody { font-size: 12px; } /* .fontMenuBody>td{ text-align: center; } */ .marginLeft { margin-left: 20px; } .marginRight { margin-right: 75px; } .footerHeight { height: 125px; } .border-theme { border: 1px solid #9bcad0a1; } .bg-theme { background-color: #e0f7faa1; } body { background: #f8fafc; } #tblInvoice { max-width: 794px; /* A4 width in px at 96dpi */ margin: 0 auto; background: #fff; box-shadow: 0 2px 8px #e0e0e0; padding: 16px 12px 24px 12px; } body, table, td, th { font-family: 'Segoe UI', 'Calibri', 'Arial', sans-serif; font-size: 12px; color: #222; } .table { border-collapse: collapse; width: 100%; background: #f8fafc; min-width: 700px; max-width: 770px; margin: 0 auto; } .table tr { height: 22px; } .table tr.fontMenuHeader, .table tr.fontMenuHeader2 { height: 26px; } td, th { border: 1.5px solid #b0b8c1; padding: 5px 8px; } .fontHeader { font-size: 24px; font-weight: 700; color: #1a355e; letter-spacing: 1px; } .fontSubHeader { font-size: 12px; font-weight: 600; color: #2d3e50; } .fontMenuHeader, .fontMenuHeader2 { font-size: 12px; font-weight: 600; background: #e3eaf6; color: #1a355e; } .fontMenuBody { font-size: 12px; background: #fff; } .bgLight, .bg1 { background: #f0f4fa !important; } .textCenter { text-align: center; } .textRight { text-align: right; } .textLeft { text-align: left; } .marginLeft { margin-left: 20px; } .marginRight { margin-right: 75px; } .footerHeight { height: 125px; } .border-theme { border: 1.5px solid #b0b8c1; } .bg-theme { background: #e3eaf6; } .tableBorderColaps { border-collapse: collapse; } .border0-bottom { border-bottom: none !important; } .border0-right { border-right: none !important; } #printFooter tfoot td { border: 1.5px solid #b0b8c1; } input.btn-success { font-family: 'Segoe UI', 'Calibri', 'Arial', sans-serif; font-size: 12px; padding: 4px 12px; border-radius: 4px; border: none; background: #1a355e; color: #fff; font-weight: 600; transition: background 0.2s; } input.btn-success:hover { background: #274a7d; } a { color: #1a355e; text-decoration: underline; } a:hover { color: #274a7d; } .font-size-2 { font-size: 11px; } .fontMenuBody > td, .fontMenuHeader > td, .fontMenuHeader2 > td { height: 17px !important; padding-top: 2px !important; padding-bottom: 2px !important; padding-left: 4px !important; padding-right: 4px !important; } .fontMenuBody, .fontMenuHeader, .fontMenuHeader2 { height: 22px !important; } </style>");
            printWindow.document.write('</head><body >');
            printWindow.document.write(divContents);
            printWindow.document.write('</body></html>');
            printWindow.document.close();
            printWindow.print();
        }
        $(document).ready(function () {
            var total_partA = 0.00, total_partB = 0.00;

            $('.partA-total').each(function () {
                let tempA = parseFloat($(this).html());
                total_partA = total_partA + tempA;
            });
            $('.partB-total').each(function () {
                let tempB = parseFloat($(this).html());
                total_partB = total_partB + tempB;
            });

            let percentage25 = 2.5;
            let percentage5 = 5;

            let pA = total_partA.toFixed(2);
            let pB = total_partB;
            let result25 = ((percentage25 / 100) * pA).toFixed(2);
            let result5 = ((percentage5 / 100) * pA).toFixed(2);
            let partASubTotal = (parseFloat(percentage5) + parseFloat(pA)).toFixed(2);
            let partBSubtotal = parseFloat(pB).toFixed(2);
            let grandTotal = parseFloat(partASubTotal) + parseFloat(partBSubtotal);

            $('#lbl_sum_partA').html(pA);
            $('#lbl_cgst').html(result25);
            $('#lbl_sgst').html(result25);
            $('#lbl_toal_gst').html(result5);

            $('#lbl_partA_subTotal').html(partASubTotal);
            $('#lbl_partB_subTotal').html(partBSubtotal);
            let finalAmt = grandTotal.toFixed(2);
            $('#lbl_grandTotal').html(finalAmt);

            let rupeesInWords = Math.round(grandTotal);
            $('#totalPartA_PartB').html(rupeesInWords);

            $.ajax({
                url: '/GstBill/Invoice/GetRupeesInwords',
                type: "POST",
                dataType: "json",
                contentType: 'application/json',
                data: JSON.stringify({ rps: parseFloat(rupeesInWords) }),
                success: function (data) {
                    $('#wordprint').html(data);
                }
            });

        });
    </script>
</body>
</html>

